# Bank Customer Churn Prediction

## Цель проекта

Основная цель данного проекта — закрепление на практике знаний о современных инструментах MLOps. В рамках проекта реализован полный цикл разработки модели машинного обучения для задачи предсказания оттока клиентов, с использованием следующих инструментов:
- **DVC (Data Version Control)** для версионирования данных и пайплайнов.
- **MLflow** для трекинга экспериментов, логирования метрик и моделей.
- **Optuna** для автоматического подбора гиперпараметров.

## Описание датасета и задачи

В проекте используется датасет [Telco Customer Churn](https://www.kaggle.com/blastchar/telco-customer-churn), содержащий информацию о клиентах телекоммуникационной компании. Целевая переменная — `Churn`, отражающая факт ухода клиента.

**Задача:** Построить модель, предсказывающую уход клиента (churn) на основе его характеристик и истории обслуживания, и обернуть весь процесс в MLOps-пайплайн.

**Признаки:**
- Категориальные: пол, возраст, наличие партнера, тип контракта, способ оплаты и др.
- Числовые: срок обслуживания (`tenure`), ежемесячные и общие платежи.

## Использованные алгоритмы

Для решения задачи классификации применялись следующие алгоритмы:
- Логистическая регрессия (`LogisticRegression`)
- Линейный метод опорных векторов (`LinearSVC`)
- Случайный лес (`RandomForestClassifier`)
- Градиентный бустинг (`GradientBoostingClassifier`)

Для балансировки классов использовалась техника SMOTEENN.

Гиперпараметры подбирались с помощью Optuna.

## Инструкции по запуску проекта

1. **Клонируйте репозиторий и установите зависимости:**
   ```bash
   git clone https://github.com/ogzeusily/mlops-pipeline-dvc-mlflow-airflow.git
   cd mlops-pipeline-dvc-mlflow-airflow
   pip install -r requirements.txt
   ```

2. **Подготовьте данные:**
   - Поместите файл `customer_churn.csv` в корень проекта.
   - Выполните команду для загрузки данных, отслеживаемых DVC (если применимо):
   ```bash
   dvc pull
   ```

3. **Запустите пайплайн DVC:**
   ```bash
   dvc repro
   ```

   Это автоматически выполнит этапы подготовки данных и обучения моделей.

## Команды для воспроизведения экспериментов

- **Запуск полного пайплайна:**
  ```bash
  dvc repro
  ```
- **Запуск подготовки данных:**
  ```bash
  dvc repro data_load
  ```
- **Запуск обучения моделей:**
  ```bash
  dvc repro train
  ```
- **Ручной запуск скриптов:**
  ```bash
  python data_loader.py
  python train_model.py
  ```

## Результаты экспериментов и выводы

В ходе экспериментов были обучены и сравнены четыре модели. Для каждой модели подбирались гиперпараметры с помощью Optuna, а результаты логировались в MLflow.

**Метрики**
| Модель                  | Accuracy | Recall | Precision | F1-score | Train time (mil sec) |
|-------------------------|----------|--------|-----------|----------|----------------------|
| LogisticRegression      | 0.993    | 0.992  | 0.996     | 0.994    | 7                    |
| LinearSVC               | 0.990    | 0.991  | 0.991     | 0.991    | 3                    |
| RandomForestClassifier  | 0.997    | 0.996  | 1.000     | 0.998    | 176                  |
| GradientBoostingClassifier | 0.999   | 0.999  | 0.998     | 0.998    | 200                  |

Подбор гиперпараметров для линейных моделей (коеффициент L2, кол-во итераций) в Optuna составило 4.3 секунды (n_trials=20)

Подбор гиперпараметров для ансамблевых моделей (глубина, кол-во объектов в листе, мин.  samples для разделения, количество деревьев) в Optuna составило 20 секунды (n_trials=10)

**Выводы:**
- Проект успешно демонстрирует полный цикл ML-разработки с применением MLOps практик.
- Использование DVC обеспечивает версионирование данных и воспроизводимость пайплайна обработки.
- MLflow позволяет эффективно отслеживать эксперименты, сравнивать модели и управлять их жизненным циклом.
- Наилучшие результаты по метрикам показали ансамблевые методы (Random Forest и Gradient Boosting), что подтверждается залогированными в MLflow данными.
- Балансировка классов и автоматический подбор гиперпараметров с помощью Optuna существенно повышают качество моделей.

---
Для детального анализа и повторения экспериментов используйте MLflow UI:
```bash
mlflow ui
```
